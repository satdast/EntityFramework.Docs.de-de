---
title: Asynchrone Programmierung-EF Core
description: Asynchrones Abfragen und Speichern von Daten mit Entity Framework Core
author: roji
ms.date: 9/2/2020
uid: core/miscellaneous/async
ms.openlocfilehash: 52b3ac20a50babbed6937ebe3365ac1947dcaef1
ms.sourcegitcommit: 032a1767d7a6e42052a005f660b80372c6521e7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/12/2021
ms.locfileid: "98128575"
---
# <a name="asynchronous-programming"></a><span data-ttu-id="815fc-103">Asynchrone Programmierung</span><span class="sxs-lookup"><span data-stu-id="815fc-103">Asynchronous Programming</span></span>

<span data-ttu-id="815fc-104">Asynchrone Vorgänge verhindern, dass ein Thread blockiert wird, während die Abfrage in der Datenbank ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="815fc-104">Asynchronous operations avoid blocking a thread while the query is executed in the database.</span></span> <span data-ttu-id="815fc-105">Asynchrone Vorgänge sind wichtig, um eine reaktionsfähige Benutzeroberfläche in Rich Client-Anwendungen zu erhalten. Außerdem kann der Durchsatz in Webanwendungen erhöht werden, wo Sie den Thread für andere Anforderungen in Webanwendungen freigeben.</span><span class="sxs-lookup"><span data-stu-id="815fc-105">Async operations are important for keeping a responsive UI in rich client applications, and can also increase throughput in web applications where they free up the thread to service other requests in web applications.</span></span>

<span data-ttu-id="815fc-106">Nach dem .NET-Standard stellt EF Core asynchrone Entsprechungen für alle synchronen Methoden bereit, die e/a-Vorgänge ausführen.</span><span class="sxs-lookup"><span data-stu-id="815fc-106">Following the .NET standard, EF Core provides asynchronous counterparts to all synchronous methods which perform I/O.</span></span> <span data-ttu-id="815fc-107">Diese haben die gleichen Auswirkungen wie die Synchronisierungs Methoden und können mit den c# `async` -und- `await` Schlüsselwörtern verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="815fc-107">These have the same effects as the sync methods, and can be used with the C# `async` and `await` keywords.</span></span> <span data-ttu-id="815fc-108">Anstatt z. b. dbcontext. SaveChanges zu verwenden, wodurch ein Thread blockiert wird, während die Datenbank-e/a-Vorgänge ausgeführt werden, kann dbcontext. savechangesasync verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="815fc-108">For example, instead of using DbContext.SaveChanges, which will block a thread while database I/O is performed, DbContext.SaveChangesAsync can be used:</span></span>

[!code-csharp[Main](../../../samples/core/Miscellaneous/Async/Program.cs#SaveChangesAsync)]

<span data-ttu-id="815fc-109">Weitere Informationen finden Sie in [der allgemeinen Dokumentation zur asynchronen Programmierung in c#](/dotnet/csharp/async).</span><span class="sxs-lookup"><span data-stu-id="815fc-109">For more information, see [the general C# asynchronous programming docs](/dotnet/csharp/async).</span></span>

> [!WARNING]
> <span data-ttu-id="815fc-110">EF Core unterstützt nicht die Ausführung mehrerer paralleler Vorgänge, die auf derselben Kontextinstanz ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="815fc-110">EF Core doesn't support multiple parallel operations being run on the same context instance.</span></span> <span data-ttu-id="815fc-111">Sie sollten immer auf den Abschluss eines Vorgangs warten, bevor Sie den nächsten starten.</span><span class="sxs-lookup"><span data-stu-id="815fc-111">You should always wait for an operation to complete before beginning the next operation.</span></span> <span data-ttu-id="815fc-112">In der Regel erfolgt dies für alle asynchronen Vorgänge durch das Schlüsselwort `await`.</span><span class="sxs-lookup"><span data-stu-id="815fc-112">This is typically done by using the `await` keyword on each async operation.</span></span>

> [!WARNING]
> <span data-ttu-id="815fc-113">Bei der asynchronen Implementierung von [Microsoft. Data. SqlClient](https://github.com/dotnet/SqlClient) sind leider einige bekannte Probleme aufgetreten (z. b. [#593](https://github.com/dotnet/SqlClient/issues/593), [#601](https://github.com/dotnet/SqlClient/issues/601)und andere).</span><span class="sxs-lookup"><span data-stu-id="815fc-113">The async implementation of [Microsoft.Data.SqlClient](https://github.com/dotnet/SqlClient) unfortunately has some known issues (e.g. [#593](https://github.com/dotnet/SqlClient/issues/593), [#601](https://github.com/dotnet/SqlClient/issues/601), and others).</span></span>

> [!NOTE]
> <span data-ttu-id="815fc-114">EF Core übergibt Abbruch Token an den verwendeten zugrunde liegenden Datenbankanbieter (z. b. Microsoft. Data. SqlClient).</span><span class="sxs-lookup"><span data-stu-id="815fc-114">EF Core passes cancellation tokens down to the underlying database provider in use (e.g. Microsoft.Data.SqlClient).</span></span> <span data-ttu-id="815fc-115">Diese Token werden möglicherweise nicht berücksichtigt. Informationen hierzu finden Sie in der Dokumentation des Datenbankanbieters.</span><span class="sxs-lookup"><span data-stu-id="815fc-115">These tokens may or may not be honored - consult your database provider's documentation.</span></span>

## <a name="async-linq-operators"></a><span data-ttu-id="815fc-116">Asynchrone LINQ-Operatoren</span><span class="sxs-lookup"><span data-stu-id="815fc-116">Async LINQ operators</span></span>

<span data-ttu-id="815fc-117">Um die asynchrone Ausführung von LINQ-Abfragen zu unterstützen, stellt EF Core einen Satz asynchroner Erweiterungs Methoden bereit, die die Abfrage ausführen und Ergebnisse zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="815fc-117">In order to support executing LINQ queries asynchronously, EF Core provides a set of async extension methods which execute the query and return results.</span></span> <span data-ttu-id="815fc-118">Diese Entsprechungen zu den standardmäßigen synchronen LINQ-Operatoren umfassen "delistasync", "singleasync", "asasyncenenerable" usw.:</span><span class="sxs-lookup"><span data-stu-id="815fc-118">These counterparts to the standard, synchronous LINQ operators include ToListAsync, SingleAsync, AsAsyncEnumerable, etc.:</span></span>

[!code-csharp[Main](../../../samples/core/Miscellaneous/Async/Program.cs#ToListAsync)]

<span data-ttu-id="815fc-119">Beachten Sie, dass es keine asynchronen Versionen einiger LINQ-Operatoren gibt, wie z. b. WHERE oder OrderBy, da diese nur die LINQ-Ausdrucks Baumstruktur erstellen und nicht bewirken, dass die Abfrage in der Datenbank ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="815fc-119">Note that there are no async versions of some LINQ operators such as Where or OrderBy, because these only build up the LINQ expression tree and don't cause the query to be executed in the database.</span></span> <span data-ttu-id="815fc-120">Nur Operatoren, die die Abfrage Ausführung bewirken, haben asynchrone Entsprechungen</span><span class="sxs-lookup"><span data-stu-id="815fc-120">Only operators which cause query execution have async counterparts.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="815fc-121">Die asynchronen Erweiterungsmethoden von EF Core werden im Namespace `Microsoft.EntityFrameworkCore` definiert.</span><span class="sxs-lookup"><span data-stu-id="815fc-121">The EF Core async extension methods are defined in the `Microsoft.EntityFrameworkCore` namespace.</span></span> <span data-ttu-id="815fc-122">Dieser Namespace muss importiert werden, damit die Methoden verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="815fc-122">This namespace must be imported for the methods to be available.</span></span>

## <a name="client-side-async-linq-operators"></a><span data-ttu-id="815fc-123">Client seitige asynchrone LINQ-Operatoren</span><span class="sxs-lookup"><span data-stu-id="815fc-123">Client-side async LINQ operators</span></span>

<span data-ttu-id="815fc-124">Die oben beschriebenen asynchronen LINQ-Operatoren können nur für EF-Abfragen verwendet werden. Sie können nicht mit der Client seitigen LINQ to Objects Abfrage verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="815fc-124">The async LINQ operators discussed above can only be used on EF queries - you cannot use them with client-side LINQ to Objects query.</span></span> <span data-ttu-id="815fc-125">Verwenden Sie das [System. Interactive. Async-Paket](https://www.nuget.org/packages/System.Interactive.Async), um Client seitige asynchrone LINQ-Vorgänge außerhalb von EF auszuführen. Dieses Paket ist besonders nützlich für die Ausführung von Vorgängen auf dem Client, die nicht zur Auswertung auf dem Server übersetzt werden können.</span><span class="sxs-lookup"><span data-stu-id="815fc-125">To perform client-side async LINQ operations outside of EF, use the [System.Interactive.Async package](https://www.nuget.org/packages/System.Interactive.Async); this package can be especially useful for performing operations on the client that cannot be translated for evaluation at the server.</span></span>

<span data-ttu-id="815fc-126">Leider verursacht der Verweis auf System. Interactive. Async mehrdeutige Aufruf Kompilierungsfehler bei LINQ-Operatoren, die auf die dbsets von EF angewendet werden. Dadurch ist es schwierig, EF und System. Interactive. Async im gleichen Projekt zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="815fc-126">Unfortunately, referencing System.Interactive.Async causes ambiguous invocation compilation errors on LINQ operators applied to EF's DbSets; this makes it hard to use both EF and System.Interactive.Async in the same project.</span></span> <span data-ttu-id="815fc-127">Um dieses Problem zu umgehen, fügen Sie Ihrem dbset asquerable hinzu:</span><span class="sxs-lookup"><span data-stu-id="815fc-127">To work around this issue, add AsQueryable to your DbSet:</span></span>

[!code-csharp[Main](../../../samples/core/Miscellaneous/AsyncWithSystemInteractive/Program.cs#SystemInteractiveAsync)]
