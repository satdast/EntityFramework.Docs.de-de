---
title: Code First-Migrationen in Team Umgebungen-EF6
description: Code First-Migrationen in Team Umgebungen in Entity Framework 6
author: ajcvickers
ms.date: 10/23/2016
uid: ef6/modeling/code-first/migrations/teams
ms.openlocfilehash: c617dc3c34e829585b21766c7738bd622890b286
ms.sourcegitcommit: 0a25c03fa65ae6e0e0e3f66bac48d59eceb96a5a
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/14/2020
ms.locfileid: "92065081"
---
# <a name="code-first-migrations-in-team-environments"></a><span data-ttu-id="1a80a-103">Code First Migrations in Team Environments (Code First-Migrationen in Teamumgebungen)</span><span class="sxs-lookup"><span data-stu-id="1a80a-103">Code First Migrations in Team Environments</span></span>
> [!NOTE]
> <span data-ttu-id="1a80a-104">In diesem Artikel wird davon ausgegangen, dass Sie wissen, wie Code First-Migrationen in einfachen Szenarien verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="1a80a-104">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="1a80a-105">Andernfalls müssen Sie [Code First-Migrationen](xref:ef6/modeling/code-first/migrations/index) lesen, bevor Sie fortfahren.</span><span class="sxs-lookup"><span data-stu-id="1a80a-105">If you don’t, then you’ll need to read [Code First Migrations](xref:ef6/modeling/code-first/migrations/index) before continuing.</span></span>

## <a name="grab-a-coffee-you-need-to-read-this-whole-article"></a><span data-ttu-id="1a80a-106">Holen Sie sich einen Kaffee. Sie müssen diesen Artikel lesen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-106">Grab a coffee, you need to read this whole article</span></span>

<span data-ttu-id="1a80a-107">Die Probleme in Team Umgebungen sind hauptsächlich das Zusammenführen von Migrationen, wenn zwei Entwickler in Ihrer lokalen Codebasis Migrationen generiert haben.</span><span class="sxs-lookup"><span data-stu-id="1a80a-107">The issues in team environments are mostly around merging migrations when two developers have generated migrations in their local code base.</span></span> <span data-ttu-id="1a80a-108">Die Schritte zum Lösen dieser Probleme sind recht einfach, Sie erfordern jedoch ein solides Verständnis der Funktionsweise von Migrationen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-108">While the steps to solve these are pretty simple, they require you to have a solid understanding of how migrations works.</span></span> <span data-ttu-id="1a80a-109">Fahren Sie nicht einfach mit dem Ende fort – nehmen Sie sich die Zeit, den gesamten Artikel zu lesen, um sicherzustellen, dass Sie erfolgreich sind.</span><span class="sxs-lookup"><span data-stu-id="1a80a-109">Please don’t just skip ahead to the end – take the time to read the whole article to ensure you are successful.</span></span>

## <a name="some-general-guidelines"></a><span data-ttu-id="1a80a-110">Allgemeine Richtlinien</span><span class="sxs-lookup"><span data-stu-id="1a80a-110">Some general guidelines</span></span>

<span data-ttu-id="1a80a-111">Bevor wir uns mit der Verwaltung von Zusammenführungs Migrationen befassen, die von mehreren Entwicklern generiert werden, finden Sie hier einige allgemeine Richtlinien, die Sie für einen erfolgreichen Einstieg einrichten</span><span class="sxs-lookup"><span data-stu-id="1a80a-111">Before we dig into how to manage merging migrations generated by multiple developers, here are some general guidelines to set you up for success.</span></span>

### <a name="each-team-member-should-have-a-local-development-database"></a><span data-ttu-id="1a80a-112">Jedes Teammitglied sollte über eine lokale Entwicklungs Datenbank verfügen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-112">Each team member should have a local development database</span></span>

<span data-ttu-id="1a80a-113">Migrationen verwenden die \*\* \_ \_ migrationshistory\*\* -Tabelle, um zu speichern, welche Migrationen auf die Datenbank angewendet wurden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-113">Migrations uses the **\_\_MigrationsHistory** table to store what migrations have been applied to the database.</span></span> <span data-ttu-id="1a80a-114">Wenn Sie über mehrere Entwickler verfügen, die unterschiedliche Migrationen erzeugen, während Sie versuchen, auf dieselbe Datenbank zu Zielen (und somit eine \*\* \_ \_ migrationshistory\*\* -Tabelle freigeben), wird die Migration sehr verwirrend.</span><span class="sxs-lookup"><span data-stu-id="1a80a-114">If you have multiple developers generating different migrations while trying to target the same database (and thus share a **\_\_MigrationsHistory** table) migrations is going to get very confused.</span></span>

<span data-ttu-id="1a80a-115">Wenn Sie Teammitglieder haben, die keine Migrationen erzeugen, besteht natürlich kein Problem, dass Sie eine zentrale Entwicklungs Datenbank gemeinsam nutzen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-115">Of course, if you have team members that aren’t generating migrations, there is no problem having them share a central development database.</span></span>

### <a name="avoid-automatic-migrations"></a><span data-ttu-id="1a80a-116">Vermeiden automatischer Migrationen</span><span class="sxs-lookup"><span data-stu-id="1a80a-116">Avoid automatic migrations</span></span>

<span data-ttu-id="1a80a-117">Die untere Zeile ist, dass automatische Migrationen anfänglich in den Team Umgebungen gut aussehen, aber in Wirklichkeit funktionieren Sie einfach nicht.</span><span class="sxs-lookup"><span data-stu-id="1a80a-117">The bottom line is that automatic migrations initially look good in team environments, but in reality they just don’t work.</span></span> <span data-ttu-id="1a80a-118">Wenn Sie wissen möchten, lesen Sie – falls nicht, können Sie mit dem nächsten Abschnitt fortfahren.</span><span class="sxs-lookup"><span data-stu-id="1a80a-118">If you want to know why, keep reading – if not, then you can skip to the next section.</span></span>

<span data-ttu-id="1a80a-119">Automatische Migrationen ermöglichen es Ihnen, das Datenbankschema so zu aktualisieren, dass es dem aktuellen Modell entspricht, ohne Code Dateien (Code basierte Migrationen) generieren zu müssen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-119">Automatic migrations allows you to have your database schema updated to match the current model without the need to generate code files (code-based migrations).</span></span> <span data-ttu-id="1a80a-120">Automatische Migrationen funktionieren in einer Team Umgebung sehr gut, wenn Sie Sie zuvor verwendet haben und nie Code basierte Migrationen generiert haben.</span><span class="sxs-lookup"><span data-stu-id="1a80a-120">Automatic migrations would work very well in a team environment if you only ever used them and never generated any code-based migrations.</span></span> <span data-ttu-id="1a80a-121">Das Problem besteht darin, dass automatische Migrationen eingeschränkt sind und keine Reihe von Vorgängen verarbeiten können – Eigenschaften-/Spalten Umbenennungen, Verschieben von Daten in eine andere Tabelle usw. Um diese Szenarien zu behandeln, erzeugen Sie am Ende Code basierte Migrationen (und Bearbeiten des Gerüst Codes), die zwischen den Änderungen gemischt werden, die von automatischen Migrationen behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-121">The problem is that automatic migrations are limited and don’t handle a number of operations – property/column renames, moving data to another table, etc. To handle these scenarios you end up generating code-based migrations (and editing the scaffolded code) that are mixed in between changes that are handled by automatic migrations.</span></span> <span data-ttu-id="1a80a-122">Dadurch ist es nahezu unmöglich, Änderungen zusammenzuführen, wenn zwei Entwickler Migrationen einchecken.</span><span class="sxs-lookup"><span data-stu-id="1a80a-122">This makes it near on impossible to merge changes when two developers check in migrations.</span></span>

## <a name="screencasts"></a><span data-ttu-id="1a80a-123">Screencasts</span><span class="sxs-lookup"><span data-stu-id="1a80a-123">Screencasts</span></span>

<span data-ttu-id="1a80a-124">Wenn Sie lieber einen Screencast sehen möchten, als diesen Artikel zu lesen, befassen sich die beiden folgenden Videos mit dem gleichen Inhalt wie dieser Artikel.</span><span class="sxs-lookup"><span data-stu-id="1a80a-124">If you'd rather watch a screencast than read this article, the following two videos cover the same content as this article.</span></span>

### <a name="video-one-migrations---under-the-hood"></a><span data-ttu-id="1a80a-125">Video 1: "Migrationen" im Hintergrund</span><span class="sxs-lookup"><span data-stu-id="1a80a-125">Video One: "Migrations - Under the Hood"</span></span>

<span data-ttu-id="1a80a-126">[Dieser Screencast](https://channel9.msdn.com/blogs/ef/migrations-under-the-hood) erläutert, wie Migrationen Informationen über das Modell nachverfolgt und verwendet, um Modelländerungen zu erkennen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-126">[This screencast](https://channel9.msdn.com/blogs/ef/migrations-under-the-hood) covers how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="video-two-migrations---team-environments"></a><span data-ttu-id="1a80a-127">Video 2: "Migrationen-Team Umgebungen"</span><span class="sxs-lookup"><span data-stu-id="1a80a-127">Video Two: "Migrations - Team Environments"</span></span>

<span data-ttu-id="1a80a-128">Auf Grundlage der Konzepte aus dem vorherigen Video behandelt [dieser Screencast](https://channel9.msdn.com/blogs/ef/migrations-team-environments) die Probleme, die in einer Team Umgebung auftreten, und wie Sie Sie beheben können.</span><span class="sxs-lookup"><span data-stu-id="1a80a-128">Building on the concepts from the previous video, [this screencast](https://channel9.msdn.com/blogs/ef/migrations-team-environments) covers the issues that arise in a team environment and how to solve them.</span></span>

## <a name="understanding-how-migrations-works"></a><span data-ttu-id="1a80a-129">Funktionsweise von Migrationen</span><span class="sxs-lookup"><span data-stu-id="1a80a-129">Understanding how migrations works</span></span>

<span data-ttu-id="1a80a-130">Der Schlüssel für die erfolgreiche Verwendung von Migrationen in einer Team Umgebung ist ein grundlegendes Verständnis dafür, wie Migrationen Informationen über das Modell zum Erkennen von Modelländerungen nachverfolgen und verwenden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-130">The key to successfully using migrations in a team environment is a basic understanding how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="the-first-migration"></a><span data-ttu-id="1a80a-131">Erste Migration</span><span class="sxs-lookup"><span data-stu-id="1a80a-131">The first migration</span></span>

<span data-ttu-id="1a80a-132">Wenn Sie die erste Migration zu Ihrem Projekt hinzufügen, führen Sie in der Paket-Manager-Konsole etwas wie " **Add-Migration First** " aus.</span><span class="sxs-lookup"><span data-stu-id="1a80a-132">When you add the first migration to your project, you run something like **Add-Migration First** in Package Manager Console.</span></span> <span data-ttu-id="1a80a-133">Die von diesem Befehl ausgeführten Schritte auf hoher Ebene sind unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="1a80a-133">The high level steps that this command performs are pictured below.</span></span>

![Erste Migration](~/ef6/media/firstmigration.png)

<span data-ttu-id="1a80a-135">Das aktuelle Modell wird aus Ihrem Code berechnet (1).</span><span class="sxs-lookup"><span data-stu-id="1a80a-135">The current model is calculated from your code (1).</span></span> <span data-ttu-id="1a80a-136">Die erforderlichen Datenbankobjekte werden dann vom Modell unterschiedlich berechnet (2) – da es sich hierbei um die erste Migration handelt, verwendet das Modell nur ein leeres Modell für den Vergleich.</span><span class="sxs-lookup"><span data-stu-id="1a80a-136">The required database objects are then calculated by the model differ (2) – since this is the first migration the model differ just uses an empty model for the comparison.</span></span> <span data-ttu-id="1a80a-137">Die erforderlichen Änderungen werden an den Code-Generator weitergegeben, um den erforderlichen Migrations Code (3) zu erstellen, der dann Ihrer Visual Studio-Projekt Mappe hinzugefügt wird (4).</span><span class="sxs-lookup"><span data-stu-id="1a80a-137">The required changes are passed to the code generator to build the required migration code (3) which is then added to your Visual Studio solution (4).</span></span>

<span data-ttu-id="1a80a-138">Zusätzlich zum eigentlichen Migrations Code, der in der Haupt Codedatei gespeichert ist, generiert Migrationen auch einige zusätzliche Code Behind-Dateien.</span><span class="sxs-lookup"><span data-stu-id="1a80a-138">In addition to the actual migration code that is stored in the main code file, migrations also generates some additional code-behind files.</span></span> <span data-ttu-id="1a80a-139">Bei diesen Dateien handelt es sich um Metadaten, die von Migrationen verwendet werden. Sie sollten nicht bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-139">These files are metadata that is used by migrations and are not something you should edit.</span></span> <span data-ttu-id="1a80a-140">Eine dieser Dateien ist eine Ressourcen Datei (. resx), die eine Momentaufnahme des Modells zu dem Zeitpunkt enthält, zu dem die Migration generiert wurde.</span><span class="sxs-lookup"><span data-stu-id="1a80a-140">One of these files is a resource file (.resx) that contains a snapshot of the model at the time the migration was generated.</span></span> <span data-ttu-id="1a80a-141">Sie sehen, wie dies im nächsten Schritt verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="1a80a-141">You’ll see how this is used in the next step.</span></span>

<span data-ttu-id="1a80a-142">An diesem Punkt würden Sie wahrscheinlich " **Update-Database** " ausführen, um die Änderungen auf die Datenbank anzuwenden, und dann die Implementierung anderer Bereiche Ihrer Anwendung durchführen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-142">At this point you would probably run **Update-Database** to apply your changes to the database, and then go about implementing other areas of your application.</span></span>

### <a name="subsequent-migrations"></a><span data-ttu-id="1a80a-143">Nachfolgende Migrationen</span><span class="sxs-lookup"><span data-stu-id="1a80a-143">Subsequent migrations</span></span>

<span data-ttu-id="1a80a-144">Wenn Sie zu einem späteren Zeitpunkt einige Änderungen an Ihrem Modell vornehmen – in unserem Beispiel fügen wir dem **Blog**eine **URL** -Eigenschaft hinzu.</span><span class="sxs-lookup"><span data-stu-id="1a80a-144">Later you come back and make some changes to your model – in our example we’ll add a **Url** property to **Blog**.</span></span> <span data-ttu-id="1a80a-145">Anschließend geben Sie einen Befehl wie " **Add-Migration addurl** " aus, um eine Migration durchzusetzen, um die entsprechenden Daten Bank Änderungen anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-145">You would then issue a command such as **Add-Migration AddUrl** to scaffold a migration to apply the corresponding database changes.</span></span> <span data-ttu-id="1a80a-146">Die von diesem Befehl ausgeführten Schritte auf hoher Ebene sind unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="1a80a-146">The high level steps that this command performs are pictured below.</span></span>

![Zweite Migration](~/ef6/media/secondmigration.png)

<span data-ttu-id="1a80a-148">Ebenso wie das letzte Mal wird das aktuelle Modell aus Code (1) berechnet.</span><span class="sxs-lookup"><span data-stu-id="1a80a-148">Just like last time, the current model is calculated from code (1).</span></span> <span data-ttu-id="1a80a-149">Dieses Mal werden jedoch Migrationen durchlaufen, damit das vorherige Modell von der neuesten Migration (2) abgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="1a80a-149">However, this time there are existing migrations so the previous model is retrieved from the latest migration (2).</span></span> <span data-ttu-id="1a80a-150">Diese beiden Modelle werden untersucht, um die erforderlichen Daten Bank Änderungen zu finden (3), und der Prozess wird wie zuvor abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-150">These two models are diffed to find the required database changes (3) and then the process completes as before.</span></span>

<span data-ttu-id="1a80a-151">Dieser Prozess wird für alle weiteren Migrationen verwendet, die Sie dem Projekt hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-151">This same process is used for any further migrations that you add to the project.</span></span>

### <a name="why-bother-with-the-model-snapshot"></a><span data-ttu-id="1a80a-152">Warum sollten Sie sich mit der Modell Momentaufnahme beschäftigen?</span><span class="sxs-lookup"><span data-stu-id="1a80a-152">Why bother with the model snapshot?</span></span>

<span data-ttu-id="1a80a-153">Sie Fragen sich vielleicht, warum EF mit der Modell Momentaufnahme zu tun hat – warum nicht nur die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="1a80a-153">You may be wondering why EF bothers with the model snapshot – why not just look at the database.</span></span> <span data-ttu-id="1a80a-154">Wenn dies der Fall ist, lesen Sie weiter.</span><span class="sxs-lookup"><span data-stu-id="1a80a-154">If so, read on.</span></span> <span data-ttu-id="1a80a-155">Wenn Sie nicht interessiert sind, können Sie diesen Abschnitt überspringen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-155">If you’re not interested then you can skip this section.</span></span>

<span data-ttu-id="1a80a-156">EF gibt eine Reihe von Gründen für die Modell Momentaufnahme aus:</span><span class="sxs-lookup"><span data-stu-id="1a80a-156">There are a number of reasons EF keeps the model snapshot around:</span></span>

-   <span data-ttu-id="1a80a-157">Dadurch kann Ihre Datenbank vom EF-Modell abweichen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-157">It allows your database to drift from the EF model.</span></span> <span data-ttu-id="1a80a-158">Diese Änderungen können direkt in der Datenbank vorgenommen werden, oder Sie können den erstellten Code in den Migrationen ändern, um die Änderungen vorzunehmen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-158">These changes can be made directly in the database, or you can change the scaffolded code in your migrations to make the changes.</span></span> <span data-ttu-id="1a80a-159">Dies sind einige Beispiele für diese Vorgehensweise:</span><span class="sxs-lookup"><span data-stu-id="1a80a-159">Here are a couple of examples of this in practice:</span></span>
    -   <span data-ttu-id="1a80a-160">Sie möchten eine eingefügte und aktualisierte Spalte zu einer oder mehreren Tabellen hinzufügen, aber Sie möchten diese Spalten nicht in das EF-Modell einschließen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-160">You want to add an Inserted and Updated to column to one or more of your tables but you don’t want to include these columns in the EF model.</span></span> <span data-ttu-id="1a80a-161">Wenn in der Datenbank Migrationen durchgeführt wurden, würde es immer wieder versuchen, diese Spalten jedes Mal zu löschen, wenn Sie ein Gerüst für eine Migration verwenden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-161">If migrations looked at the database it would continually try to drop these columns every time you scaffolded a migration.</span></span> <span data-ttu-id="1a80a-162">Mit der Modell Momentaufnahme erkennt EF immer nur legitime Änderungen am Modell.</span><span class="sxs-lookup"><span data-stu-id="1a80a-162">Using the model snapshot, EF will only ever detect legitimate changes to the model.</span></span>
    -   <span data-ttu-id="1a80a-163">Sie möchten den Text einer gespeicherten Prozedur ändern, die für Updates verwendet wird, um die Protokollierung einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-163">You want to change the body of a stored procedure used for updates to include some logging.</span></span> <span data-ttu-id="1a80a-164">Wenn die Migrationen diese gespeicherte Prozedur aus der Datenbank betrachten, wird diese regelmäßig wieder auf die Definition zurückgesetzt, die EF erwartet.</span><span class="sxs-lookup"><span data-stu-id="1a80a-164">If migrations looked at this stored procedure from the database it would continually try and reset it back to the definition that EF expects.</span></span> <span data-ttu-id="1a80a-165">Durch die Verwendung der Modell Momentaufnahme erstellt EF immer nur einen gerüstalten Code, um die gespeicherte Prozedur zu ändern, wenn Sie die Form der Prozedur im EF-Modell ändern.</span><span class="sxs-lookup"><span data-stu-id="1a80a-165">By using the model snapshot, EF will only ever scaffold code to alter the stored procedure when you change the shape of the procedure in the EF model.</span></span>
    -   <span data-ttu-id="1a80a-166">Die gleichen Prinzipien gelten für das Hinzufügen zusätzlicher Indizes, einschließlich zusätzlicher Tabellen in der Datenbank, die Zuordnung von EF zu einer Daten Bank Sicht, die sich über einer Tabelle befindet, usw.</span><span class="sxs-lookup"><span data-stu-id="1a80a-166">These same principles apply to adding extra indexes, including extra tables in your database, mapping EF to a database view that sits over a table, etc.</span></span>
-   <span data-ttu-id="1a80a-167">Das EF-Modell enthält mehr als nur die Form der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="1a80a-167">The EF model contains more than just the shape of the database.</span></span> <span data-ttu-id="1a80a-168">Das gesamte Modell ermöglicht Migrationen, Informationen zu den Eigenschaften und Klassen in Ihrem Modell und deren Zuordnung zu den Spalten und Tabellen zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-168">Having the entire model allows migrations to look at information about the properties and classes in your model and how they map to the columns and tables.</span></span> <span data-ttu-id="1a80a-169">Diese Informationen ermöglichen es, dass Migrationen in dem Code, den Sie Gerüsten, intelligenter werden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-169">This information allows migrations to be more intelligent in the code that it scaffolds.</span></span> <span data-ttu-id="1a80a-170">Wenn Sie z. b. den Namen der Spalte ändern, die eine Eigenschaft migriert, können Sie die Umbenennung erkennen, indem Sie sehen, dass es sich um dieselbe Eigenschaft handelt – etwas, das nicht ausgeführt werden kann, wenn Sie nur über das Datenbankschema verfügen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-170">For example, if you change the name of the column that a property maps to migrations can detect the rename by seeing that it’s the same property – something that can’t be done if you only have the database schema.</span></span> 

## <a name="what-causes-issues-in-team-environments"></a><span data-ttu-id="1a80a-171">Was verursacht Probleme in Team Umgebungen?</span><span class="sxs-lookup"><span data-stu-id="1a80a-171">What causes issues in team environments</span></span>

<span data-ttu-id="1a80a-172">Der im vorherigen Abschnitt behandelte Workflow funktioniert hervorragend, wenn Sie ein einzelner Entwickler an einer Anwendung arbeiten.</span><span class="sxs-lookup"><span data-stu-id="1a80a-172">The workflow covered in the previous section works great when you are a single developer working on an application.</span></span> <span data-ttu-id="1a80a-173">Es funktioniert auch gut in einer Team Umgebung, wenn Sie die einzige Person sind, die Änderungen am Modell vornimmt.</span><span class="sxs-lookup"><span data-stu-id="1a80a-173">It also works well in a team environment if you are the only person making changes to the model.</span></span> <span data-ttu-id="1a80a-174">In diesem Szenario können Sie Modelländerungen vornehmen, Migrationen generieren und diese an die Quell Code Verwaltung senden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-174">In this scenario you can make model changes, generate migrations and submit them to your source control.</span></span> <span data-ttu-id="1a80a-175">Andere Entwickler können Ihre Änderungen synchronisieren und **Update-Database** ausführen, damit die Schema Änderungen angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-175">Other developers can sync your changes and run **Update-Database** to have the schema changes applied.</span></span>

<span data-ttu-id="1a80a-176">Es treten Probleme auf, wenn mehrere Entwickler Änderungen am EF-Modell vornehmen und gleichzeitig an die Quell Code Verwaltung senden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-176">Issues start to arise when you have multiple developers making changes to the EF model and submitting to source control at the same time.</span></span> <span data-ttu-id="1a80a-177">Was EF fehlt, ist eine erstklassige Möglichkeit, ihre lokalen Migrationen mit Migrationen zusammenzuführen, die von einem anderen Entwickler seit der letzten Synchronisierung an die Quell Code Verwaltung übermittelt wurden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-177">What EF lacks is a first class way to merge your local migrations with migrations that another developer has submitted to source control since you last synced.</span></span>

## <a name="an-example-of-a-merge-conflict"></a><span data-ttu-id="1a80a-178">Ein Beispiel für einen Mergekonflikt</span><span class="sxs-lookup"><span data-stu-id="1a80a-178">An example of a merge conflict</span></span>

<span data-ttu-id="1a80a-179">Zunächst sehen wir uns ein konkretes Beispiel für einen solchen Mergekonflikt an.</span><span class="sxs-lookup"><span data-stu-id="1a80a-179">First let’s look at a concrete example of such a merge conflict.</span></span> <span data-ttu-id="1a80a-180">Wir arbeiten mit dem Beispiel fort, das wir zuvor gesehen haben.</span><span class="sxs-lookup"><span data-stu-id="1a80a-180">We’ll continue on with the example we looked at earlier.</span></span> <span data-ttu-id="1a80a-181">Als Ausgangspunkt gehen wir davon aus, dass die Änderungen aus dem vorherigen Abschnitt vom ursprünglichen Entwickler eingeglichen wurden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-181">As a starting point let’s assume the changes from the previous section were checked in by the original developer.</span></span> <span data-ttu-id="1a80a-182">Wir verfolgen zwei Entwickler nach, wenn Sie Änderungen an der Codebasis vornehmen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-182">We’ll track two developers as they make changes to code base.</span></span>

<span data-ttu-id="1a80a-183">Wir verfolgen das EF-Modell und die Migrationen durch eine Reihe von Änderungen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-183">We’ll track the EF model and the migrations thru a number of changes.</span></span> <span data-ttu-id="1a80a-184">Als Ausgangspunkt haben beide Entwickler mit dem Quellcodeverwaltungs-Repository synchronisiert, wie in der folgenden Abbildung dargestellt.</span><span class="sxs-lookup"><span data-stu-id="1a80a-184">For a starting point, both developers have synced to the source control repository, as depicted in the following graphic.</span></span>

![Startpunkt](~/ef6/media/startingpoint.png)

<span data-ttu-id="1a80a-186">Developer \# 1 und Developer \# 2 nimmt nun einige Änderungen am EF-Modell in der lokalen Codebasis vor.</span><span class="sxs-lookup"><span data-stu-id="1a80a-186">Developer \#1 and developer \#2 now makes some changes to the EF model in their local code base.</span></span> <span data-ttu-id="1a80a-187">Entwickler \# 1 fügt dem **Blog** – eine **Bewertungs** Eigenschaft hinzu und generiert eine **addrating** -Migration, um die Änderungen auf die Datenbank anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-187">Developer \#1 adds a **Rating** property to **Blog** – and generates an **AddRating** migration to apply the changes to the database.</span></span> <span data-ttu-id="1a80a-188">Developer \# 2 fügt dem **Blog** – eine **Readers** -Eigenschaft hinzu und generiert die entsprechende Migration von **adressadern** .</span><span class="sxs-lookup"><span data-stu-id="1a80a-188">Developer \#2 adds a **Readers** property to **Blog** – and generates the corresponding **AddReaders** migration.</span></span> <span data-ttu-id="1a80a-189">Beide Entwickler führen **Update-Database**aus, um die Änderungen auf Ihre lokalen Datenbanken anzuwenden und dann die Entwicklung der Anwendung fortzusetzen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-189">Both developers run **Update-Database**, to apply the changes to their local databases, and then continue developing the application.</span></span>

> [!NOTE]
> <span data-ttu-id="1a80a-190">Migrationen wird ein Zeitstempel vorangestellt. Daher stellt unsere Grafik dar, dass die Migration der adressader von Developer \# 2 nach der Migration von Developer \# 1 erfolgt.</span><span class="sxs-lookup"><span data-stu-id="1a80a-190">Migrations are prefixed with a timestamp, so our graphic represents that the AddReaders migration from Developer \#2 comes after the AddRating migration from Developer \#1.</span></span> <span data-ttu-id="1a80a-191">Ob Entwickler \# 1 oder \# 2 die Migration zuerst generiert haben, ist kein Unterschied zu den Problemen bei der Arbeit in einem Team oder dem Verfahren zum Zusammenführen der Daten, die wir im nächsten Abschnitt betrachten werden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-191">Whether developer \#1 or \#2 generated the migration first makes no difference to the issues of working in a team, or the process for merging them that we’ll look at in the next section.</span></span>

![Lokale Änderungen](~/ef6/media/localchanges.png)

<span data-ttu-id="1a80a-193">Es ist ein glücklicher Tag für Developer \# 1, da Sie Ihre Änderungen zuerst übermitteln.</span><span class="sxs-lookup"><span data-stu-id="1a80a-193">It’s a lucky day for Developer \#1 as they happen to submit their changes first.</span></span> <span data-ttu-id="1a80a-194">Da keine andere Person eingehakt hat, weil Sie Ihr Repository synchronisiert haben, können Sie Ihre Änderungen nur übermitteln, ohne eine Zusammenführung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-194">Because no one else has checked in since they synced their repository, they can just submit their changes without performing any merging.</span></span>

![Änderungen senden](~/ef6/media/submit.png)

<span data-ttu-id="1a80a-196">Jetzt ist es an der Zeit \# , Entwickler 2 zu übermitteln.</span><span class="sxs-lookup"><span data-stu-id="1a80a-196">Now it’s time for Developer \#2 to submit.</span></span> <span data-ttu-id="1a80a-197">Sie sind nicht so glücklich.</span><span class="sxs-lookup"><span data-stu-id="1a80a-197">They aren’t so lucky.</span></span> <span data-ttu-id="1a80a-198">Da eine andere Person Änderungen gesendet hat, seit Sie synchronisiert wurden, müssen Sie die Änderungen abrufen und zusammenführen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-198">Because someone else has submitted changes since they synced, they will need to pull down the changes and merge.</span></span> <span data-ttu-id="1a80a-199">Das Quell Code Verwaltungssystem kann die Änderungen wahrscheinlich auf Codeebene automatisch zusammenführen, da Sie sehr einfach sind.</span><span class="sxs-lookup"><span data-stu-id="1a80a-199">The source control system will likely be able to automatically merge the changes at the code level since they are very simple.</span></span> <span data-ttu-id="1a80a-200">Der Status des \# lokalen Repository von Developer 2 nach der Synchronisierung wird in der folgenden Abbildung dargestellt.</span><span class="sxs-lookup"><span data-stu-id="1a80a-200">The state of Developer \#2’s local repository after syncing is depicted in the following graphic.</span></span> 

![Aus Quell Code Verwaltung abrufen](~/ef6/media/pull.png)

<span data-ttu-id="1a80a-202">Auf dieser Stufe \# kann Developer 2 **Update-Database** ausführen, wodurch die neue Migrations **AddRating** Migration (die noch nicht auf \# die Datenbank von Developer 2 angewendet wurde) erkannt und angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="1a80a-202">At this stage Developer \#2 can run **Update-Database** which will detect the new **AddRating** migration (which hasn’t been applied to Developer \#2’s database) and apply it.</span></span> <span data-ttu-id="1a80a-203">Nun wird die Spalte **Bewertung** der Tabelle **Blogs** hinzugefügt, und die Datenbank ist mit dem Modell synchron.</span><span class="sxs-lookup"><span data-stu-id="1a80a-203">Now the **Rating** column is added to the **Blogs** table and the database is in sync with the model.</span></span>

<span data-ttu-id="1a80a-204">Es gibt jedoch einige Probleme:</span><span class="sxs-lookup"><span data-stu-id="1a80a-204">There are a couple of problems though:</span></span>

1.  <span data-ttu-id="1a80a-205">Obwohl **Update-Database** die Migration **addrating** anwendet, wird auch eine Warnung ausgegeben: die *Datenbank kann nicht so aktualisiert werden, dass Sie mit dem aktuellen Modell identisch ist, weil ausstehende Änderungen vorhanden sind und die automatische Migration deaktiviert ist...*</span><span class="sxs-lookup"><span data-stu-id="1a80a-205">Although **Update-Database** will apply the **AddRating** migration it will also raise a warning: *Unable to update database to match the current model because there are pending changes and automatic migration is disabled…*</span></span>
    <span data-ttu-id="1a80a-206">Das Problem besteht darin, dass in der in der letzten Migration (dem**adressader**) gespeicherten Modell Momentaufnahme die **Bewertungs** Eigenschaft im **Blog** fehlt (da Sie beim Generieren der Migration nicht Teil des Modells war).</span><span class="sxs-lookup"><span data-stu-id="1a80a-206">The problem is that the model snapshot stored in the last migration (**AddReader**) is missing the **Rating** property on **Blog** (since it wasn’t part of the model when the migration was generated).</span></span> <span data-ttu-id="1a80a-207">Code First erkennt, dass das Modell in der letzten Migration nicht mit dem aktuellen Modell identisch ist, und löst die Warnung aus.</span><span class="sxs-lookup"><span data-stu-id="1a80a-207">Code First detects that the model in the last migration doesn’t match the current model and raises the warning.</span></span>
2.  <span data-ttu-id="1a80a-208">Das Ausführen der Anwendung führt zu einer InvalidOperationException, die besagt, dass sich*das Modell, das den bloggingcontext-Kontext unterstützt, seit der Erstellung der Datenbank geändert hat. Verwenden Sie Code First-Migrationen, um die Datenbank zu aktualisieren... "*</span><span class="sxs-lookup"><span data-stu-id="1a80a-208">Running the application would result in an InvalidOperationException stating that “*The model backing the 'BloggingContext' context has changed since the database was created. Consider using Code First Migrations to update the database…”*</span></span>
    <span data-ttu-id="1a80a-209">Das Problem ist, dass die in der letzten Migration gespeicherte Modell Momentaufnahme nicht mit dem aktuellen Modell identisch ist.</span><span class="sxs-lookup"><span data-stu-id="1a80a-209">Again, the problem is the model snapshot stored in the last migration doesn’t match the current model.</span></span>
3.  <span data-ttu-id="1a80a-210">Schließlich würden wir erwarten, dass durch das Ausführen von " **Add-Migration** " nun eine leere Migration generiert wird (da es keine Änderungen gibt, die auf die Datenbank angewendet werden müssen).</span><span class="sxs-lookup"><span data-stu-id="1a80a-210">Finally, we would expect running **Add-Migration** now would generate an empty migration (since there are no changes to apply to the database).</span></span> <span data-ttu-id="1a80a-211">Doch da Migrationen das aktuelle Modell mit dem der letzten Migration vergleichen (was die **Bewertungs** Eigenschaft fehlt), wird ein weiterer **AddColumn** -Befehl zum Hinzufügen in der **Bewertungs** Spalte erstellt.</span><span class="sxs-lookup"><span data-stu-id="1a80a-211">But because migrations compares the current model to the one from the last migration (which is missing the **Rating** property) it will actually scaffold another **AddColumn** call to add in the **Rating** column.</span></span> <span data-ttu-id="1a80a-212">Natürlich würde diese Migration bei **Update-Database** fehlschlagen, da die **Bewertungs** Spalte bereits vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="1a80a-212">Of course, this migration would fail during **Update-Database** because the **Rating** column already exists.</span></span>

## <a name="resolving-the-merge-conflict"></a><span data-ttu-id="1a80a-213">Auflösen des Mergekonflikts</span><span class="sxs-lookup"><span data-stu-id="1a80a-213">Resolving the merge conflict</span></span>

<span data-ttu-id="1a80a-214">Die gute Nachricht ist, dass es nicht zu schwierig ist, den Merge manuell zu behandeln – vorausgesetzt, Sie haben ein Verständnis für die Funktionsweise von Migrationen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-214">The good news is that it’s not too hard to deal with the merge manually – provided you have an understanding of how migrations works.</span></span> <span data-ttu-id="1a80a-215">Wenn Sie also diesen Abschnitt übersprungen haben...</span><span class="sxs-lookup"><span data-stu-id="1a80a-215">So if you’ve skipped ahead to this section…</span></span> <span data-ttu-id="1a80a-216">Leider müssen Sie den Rest des Artikels zuerst lesen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-216">sorry, you need to go back and read the rest of the article first!</span></span>

<span data-ttu-id="1a80a-217">Es gibt zwei Möglichkeiten: am einfachsten ist es, eine leere Migration zu generieren, die das richtige aktuelle Modell als Momentaufnahme hat.</span><span class="sxs-lookup"><span data-stu-id="1a80a-217">There are two options, the easiest is to generate a blank migration that has the correct current model as a snapshot.</span></span> <span data-ttu-id="1a80a-218">Die zweite Option besteht darin, die Momentaufnahme in der letzten Migration zu aktualisieren, damit die richtige Modell Momentaufnahme vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="1a80a-218">The second option is to update the snapshot in the last migration to have the correct model snapshot.</span></span> <span data-ttu-id="1a80a-219">Die zweite Option ist ein wenig schwieriger und kann nicht in jedem Szenario verwendet werden, aber Sie ist auch sauberer, da Sie keine zusätzliche Migration hinzufügen muss.</span><span class="sxs-lookup"><span data-stu-id="1a80a-219">The second option is a little harder and can’t be used in every scenario, but it’s also cleaner because it doesn’t involve adding an extra migration.</span></span>

### <a name="option-1-add-a-blank-merge-migration"></a><span data-ttu-id="1a80a-220">Option 1: Hinzufügen einer leeren Migration "Merge"</span><span class="sxs-lookup"><span data-stu-id="1a80a-220">Option 1: Add a blank ‘merge’ migration</span></span>

<span data-ttu-id="1a80a-221">Bei dieser Option generieren wir lediglich eine leere Migration, um sicherzustellen, dass die aktuelle Migration die richtige Modell Momentaufnahme enthält.</span><span class="sxs-lookup"><span data-stu-id="1a80a-221">In this option we generate a blank migration solely for the purpose of making sure the latest migration has the correct model snapshot stored in it.</span></span>

<span data-ttu-id="1a80a-222">Diese Option kann unabhängig von der Person verwendet werden, die die letzte Migration generiert hat.</span><span class="sxs-lookup"><span data-stu-id="1a80a-222">This option can be used regardless of who generated the last migration.</span></span> <span data-ttu-id="1a80a-223">In dem Beispiel, das dem Entwickler \# 2 folgt, wird die Zusammenführung übernommen und die letzte Migration generiert.</span><span class="sxs-lookup"><span data-stu-id="1a80a-223">In the example we’ve been following Developer \#2 is taking care of the merge and they happened to generate the last migration.</span></span> <span data-ttu-id="1a80a-224">Diese Schritte können jedoch auch verwendet werden, wenn Developer \# 1 die letzte Migration generiert hat.</span><span class="sxs-lookup"><span data-stu-id="1a80a-224">But these same steps can be used if Developer \#1 generated the last migration.</span></span> <span data-ttu-id="1a80a-225">Diese Schritte gelten auch, wenn mehrere Migrationen beteiligt sind – wir haben gerade zwei untersucht, um Sie einfach zu halten.</span><span class="sxs-lookup"><span data-stu-id="1a80a-225">The steps also apply if there are multiple migrations involved – we’ve just been looking at two in order to keep it simple.</span></span>

<span data-ttu-id="1a80a-226">Der folgende Prozess kann für diese Vorgehensweise verwendet werden, beginnend ab dem Zeitpunkt, an dem Sie wissen, dass Sie über Änderungen verfügen, die über die Quell Code Verwaltung synchronisiert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-226">The following process can be used for this approach, starting from the time you realize you have changes that need to be synced from source control.</span></span>

1.  <span data-ttu-id="1a80a-227">Stellen Sie sicher, dass alle ausstehenden Modelländerungen in der lokalen Codebasis in eine Migration geschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-227">Ensure any pending model changes in your local code base have been written to a migration.</span></span> <span data-ttu-id="1a80a-228">Mit diesem Schritt wird sichergestellt, dass Sie keine legitimen Änderungen übersehen, wenn es an der Zeit ist, die leere Migration zu generieren.</span><span class="sxs-lookup"><span data-stu-id="1a80a-228">This step ensures you don’t miss any legitimate changes when it comes time to generate the blank migration.</span></span>
2.  <span data-ttu-id="1a80a-229">Mit Quell Code Verwaltung synchronisieren.</span><span class="sxs-lookup"><span data-stu-id="1a80a-229">Sync with source control.</span></span>
3.  <span data-ttu-id="1a80a-230">Führen Sie **Update-Database** aus, um alle neuen Migrationen anzuwenden, die andere Entwickler eingecheckten.</span><span class="sxs-lookup"><span data-stu-id="1a80a-230">Run **Update-Database** to apply any new migrations that other developers have checked in.</span></span>
    <span data-ttu-id="1a80a-231">**_Hinweis:_** *Wenn Sie keine Warnungen vom Update-Database Befehl erhalten, gab es keine neuen Migrationen von anderen Entwicklern, und es besteht keine Notwendigkeit, eine weitere Zusammenführung auszuführen.*</span><span class="sxs-lookup"><span data-stu-id="1a80a-231">**_Note:_** *if you don’t get any warnings from the Update-Database command then there were no new migrations from other developers and there is no need to perform any further merging.*</span></span>
4.  <span data-ttu-id="1a80a-232">Ausführen von **Add-Migration &lt; Pick \_ a \_ Name &gt; – ignorechanges** (z. b. **Add-Migration Merge – ignorechanges**).</span><span class="sxs-lookup"><span data-stu-id="1a80a-232">Run **Add-Migration &lt;pick\_a\_name&gt; –IgnoreChanges** (for example, **Add-Migration Merge –IgnoreChanges**).</span></span> <span data-ttu-id="1a80a-233">Dadurch wird eine Migration mit allen Metadaten (einschließlich einer Momentaufnahme des aktuellen Modells) generiert, aber alle Änderungen, die erkannt werden, beim Vergleich des aktuellen Modells mit der Momentaufnahme in den letzten Migrationen werden ignoriert (was bedeutet, dass Sie eine leere **up** -und **down** -Methode erhalten).</span><span class="sxs-lookup"><span data-stu-id="1a80a-233">This generates a migration with all the metadata (including a snapshot of the current model) but will ignore any changes it detects when comparing the current model to the snapshot in the last migrations (meaning you get a blank **Up** and **Down** method).</span></span>
5.  <span data-ttu-id="1a80a-234">Führen Sie **Update-Database** aus, um die neueste Migration mit den aktualisierten Metadaten erneut anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-234">Run **Update-Database** to re-apply the latest migration with the updated metadata.</span></span>
6.  <span data-ttu-id="1a80a-235">Setzen Sie die Entwicklung fort, oder übermitteln Sie die Quell Code Verwaltung (nachdem Sie die Komponententests natürlich ausgeführt haben).</span><span class="sxs-lookup"><span data-stu-id="1a80a-235">Continue developing, or submit to source control (after running your unit tests of course).</span></span>

<span data-ttu-id="1a80a-236">\#Nach diesem Ansatz wird der lokale Codebasis von Developer 2 angezeigt.</span><span class="sxs-lookup"><span data-stu-id="1a80a-236">Here is the state of Developer \#2’s local code base after using this approach.</span></span>

![Zusammenführen der Migration](~/ef6/media/mergemigration.png)

### <a name="option-2-update-the-model-snapshot-in-the-last-migration"></a><span data-ttu-id="1a80a-238">Option 2: Aktualisieren der Modell Momentaufnahme in der letzten Migration</span><span class="sxs-lookup"><span data-stu-id="1a80a-238">Option 2: Update the model snapshot in the last migration</span></span>

<span data-ttu-id="1a80a-239">Diese Option ist mit Option 1 sehr ähnlich, entfernt jedoch die zusätzliche leere Migration – da wir Sie sehen können, wer zusätzliche Code Dateien in der Projekt Mappe wünscht.</span><span class="sxs-lookup"><span data-stu-id="1a80a-239">This option is very similar to option 1 but removes the extra blank migration – because let’s face it, who wants extra code files in their solution.</span></span>

<span data-ttu-id="1a80a-240">**Diese Vorgehensweise ist nur möglich, wenn die aktuelle Migration nur in der lokalen Codebasis vorhanden ist und noch nicht an die Quell Code Verwaltung übermittelt wurde (z. b. wenn die letzte Migration vom Benutzer generiert wurde, der die Zusammenführung durchgeführt hat)**.</span><span class="sxs-lookup"><span data-stu-id="1a80a-240">**This approach is only feasible if the latest migration exists only in your local code base and has not yet been submitted to source control (for example, if the last migration was generated by the user doing the merge)**.</span></span> <span data-ttu-id="1a80a-241">Das Bearbeiten der Metadaten von Migrationen, die andere Entwickler möglicherweise bereits auf Ihre Entwicklungs Datenbank angewendet haben – oder noch schlimmer auf eine Produktionsdatenbank – kann zu unerwarteten Nebeneffekten führen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-241">Editing the metadata of migrations that other developers may have already applied to their development database – or even worse applied to a production database – can result in unexpected side effects.</span></span> <span data-ttu-id="1a80a-242">Während des Vorgangs wird für die letzte Migration in der lokalen Datenbank ein Rollback ausgeführt und mit aktualisierten Metadaten erneut angewendet.</span><span class="sxs-lookup"><span data-stu-id="1a80a-242">During the process we’re going to roll back the last migration in our local database and re-apply it with updated metadata.</span></span>

<span data-ttu-id="1a80a-243">Während sich die letzte Migration nur in der lokalen Codebasis befinden muss, gibt es keine Einschränkungen hinsichtlich der Anzahl oder Reihenfolge der Migrationen, die Sie fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-243">While the last migration needs to just be in the local code base there are no restrictions to the number or order of migrations that proceed it.</span></span> <span data-ttu-id="1a80a-244">Es können mehrere Migrationen von mehreren verschiedenen Entwicklern vorhanden sein, und die gleichen Schritte werden angewendet – wir haben gerade nur zwei untersucht, um Sie einfach zu halten.</span><span class="sxs-lookup"><span data-stu-id="1a80a-244">There can be multiple migrations from multiple different developers and the same steps apply– we’ve just been looking at two in order to keep it simple.</span></span>

<span data-ttu-id="1a80a-245">Der folgende Prozess kann für diese Vorgehensweise verwendet werden, beginnend ab dem Zeitpunkt, an dem Sie wissen, dass Sie über Änderungen verfügen, die über die Quell Code Verwaltung synchronisiert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-245">The following process can be used for this approach, starting from the time you realize you have changes that need to be synced from source control.</span></span>

1.  <span data-ttu-id="1a80a-246">Stellen Sie sicher, dass alle ausstehenden Modelländerungen in der lokalen Codebasis in eine Migration geschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-246">Ensure any pending model changes in your local code base have been written to a migration.</span></span> <span data-ttu-id="1a80a-247">Mit diesem Schritt wird sichergestellt, dass Sie keine legitimen Änderungen übersehen, wenn es an der Zeit ist, die leere Migration zu generieren.</span><span class="sxs-lookup"><span data-stu-id="1a80a-247">This step ensures you don’t miss any legitimate changes when it comes time to generate the blank migration.</span></span>
2.  <span data-ttu-id="1a80a-248">Synchronisierung mit der Quell Code Verwaltung.</span><span class="sxs-lookup"><span data-stu-id="1a80a-248">Sync with the source control.</span></span>
3.  <span data-ttu-id="1a80a-249">Führen Sie **Update-Database** aus, um alle neuen Migrationen anzuwenden, die andere Entwickler eingecheckten.</span><span class="sxs-lookup"><span data-stu-id="1a80a-249">Run **Update-Database** to apply any new migrations that other developers have checked in.</span></span>
    <span data-ttu-id="1a80a-250">**_Hinweis:_** *Wenn Sie keine Warnungen vom Update-Database Befehl erhalten, gab es keine neuen Migrationen von anderen Entwicklern, und es besteht keine Notwendigkeit, eine weitere Zusammenführung auszuführen.*</span><span class="sxs-lookup"><span data-stu-id="1a80a-250">**_Note:_** *if you don’t get any warnings from the Update-Database command then there were no new migrations from other developers and there is no need to perform any further merging.*</span></span>
4.  <span data-ttu-id="1a80a-251">Führen Sie \*\*Update-Database – targetmigration &lt; zweite \_ Letzte \_ Migration &gt; \*\* aus (in dem Beispiel, das folgt, wäre " **Update-Database" – targetmigration addrating**).</span><span class="sxs-lookup"><span data-stu-id="1a80a-251">Run **Update-Database –TargetMigration &lt;second\_last\_migration&gt;** (in the example we’ve been following this would be **Update-Database –TargetMigration AddRating**).</span></span> <span data-ttu-id="1a80a-252">Dadurch wird die Datenbank wieder in den Zustand der zweiten letzten Migration versetzt – wodurch die letzte Migration von der Datenbank deaktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="1a80a-252">This rolls the database back to the state of the second last migration – effectively ‘un-applying’ the last migration from the database.</span></span>
    <span data-ttu-id="1a80a-253">**_Hinweis:_** *dieser Schritt ist erforderlich, damit die Metadaten der Migration sicher bearbeitet werden können, da die Metadaten auch in der \_ \_ migrationshistorytable der Datenbank gespeichert werden. Aus diesem Grund sollten Sie diese Option nur verwenden, wenn die letzte Migration nur in der lokalen Codebasis erfolgt. Wenn die letzte Migration für andere Datenbanken angewendet wurde, müssten Sie auch ein Rollback durchführen und die letzte Migration erneut anwenden, um die Metadaten zu aktualisieren.*</span><span class="sxs-lookup"><span data-stu-id="1a80a-253">**_Note:_** *This step is required to make it safe to edit the metadata of the migration since the metadata is also stored in the \_\_MigrationsHistoryTable of the database. This is why you should only use this option if the last migration is only in your local code base. If other databases had the last migration applied you would also have to roll them back and re-apply the last migration to update the metadata.*</span></span> 
5.  <span data-ttu-id="1a80a-254">Führen **Sie den vollständigen Namen der Add-Migration &lt; \_ \_ einschließlich \_ Zeitstempel \_ der \_ letzten \_ Migration aus** &gt; (in dem Beispiel, das folgt, wie etwa **Add-Migration 201311062215252- \_ adressader**).</span><span class="sxs-lookup"><span data-stu-id="1a80a-254">Run **Add-Migration &lt;full\_name\_including\_timestamp\_of\_last\_migration**&gt; (in the example we’ve been following this would be something like **Add-Migration 201311062215252\_AddReaders**).</span></span>
    <span data-ttu-id="1a80a-255">**_Hinweis:_** *Sie müssen den Zeitstempel einschließen, damit Migrationen wissen, dass Sie die vorhandene Migration bearbeiten möchten, anstatt eine neue zu Gerüstbau.*</span><span class="sxs-lookup"><span data-stu-id="1a80a-255">**_Note:_** *You need to include the timestamp so that migrations knows you want to edit the existing migration rather than scaffolding a new one.*</span></span>
    <span data-ttu-id="1a80a-256">Dadurch werden die Metadaten für die letzte Migration entsprechend dem aktuellen Modell aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="1a80a-256">This will update the metadata for the last migration to match the current model.</span></span> <span data-ttu-id="1a80a-257">Wenn der Befehl abgeschlossen ist, erhalten Sie die folgende Warnung, aber genau das ist das, was Sie möchten.</span><span class="sxs-lookup"><span data-stu-id="1a80a-257">You’ll get the following warning when the command completes, but that’s exactly what you want.</span></span> <span data-ttu-id="1a80a-258">"*Nur der Designer Code für die Migration der 201311062215252 \_ -adressader wurde neu gerüsteht. Verwenden Sie den Parameter "-Force", um die gesamte Migration neu zu erstellen.*</span><span class="sxs-lookup"><span data-stu-id="1a80a-258">“*Only the Designer Code for migration '201311062215252\_AddReaders' was re-scaffolded. To re-scaffold the entire migration, use the -Force parameter.”*</span></span>
6.  <span data-ttu-id="1a80a-259">Führen Sie **Update-Database** aus, um die neueste Migration mit den aktualisierten Metadaten erneut anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-259">Run **Update-Database** to re-apply the latest migration with the updated metadata.</span></span>
7.  <span data-ttu-id="1a80a-260">Setzen Sie die Entwicklung fort, oder übermitteln Sie die Quell Code Verwaltung (nachdem Sie die Komponententests natürlich ausgeführt haben).</span><span class="sxs-lookup"><span data-stu-id="1a80a-260">Continue developing, or submit to source control (after running your unit tests of course).</span></span>

<span data-ttu-id="1a80a-261">\#Nach diesem Ansatz wird der lokale Codebasis von Developer 2 angezeigt.</span><span class="sxs-lookup"><span data-stu-id="1a80a-261">Here is the state of Developer \#2’s local code base after using this approach.</span></span>

![Aktualisierte Metadaten](~/ef6/media/updatedmetadata.png)

## <a name="summary"></a><span data-ttu-id="1a80a-263">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="1a80a-263">Summary</span></span>

<span data-ttu-id="1a80a-264">Bei der Verwendung von Code First-Migrationen in einer Team Umgebung gibt es einige Herausforderungen.</span><span class="sxs-lookup"><span data-stu-id="1a80a-264">There are some challenges when using Code First Migrations in a team environment.</span></span> <span data-ttu-id="1a80a-265">Ein grundlegendes Verständnis der Funktionsweise von Migrationen und einige einfache Ansätze zum Auflösen von Mergekonflikten erleichtern es Ihnen, diese Herausforderungen zu meistern.</span><span class="sxs-lookup"><span data-stu-id="1a80a-265">However, a basic understanding of how migrations works and some simple approaches for resolving merge conflicts make it easy to overcome these challenges.</span></span>

<span data-ttu-id="1a80a-266">Das grundlegende Problem sind falsche Metadaten, die in der letzten Migration gespeichert wurden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-266">The fundamental issue is incorrect metadata stored in the latest migration.</span></span> <span data-ttu-id="1a80a-267">Dies bewirkt, dass Code First fälschlicherweise erkennen, dass das aktuelle Modell und das Datenbankschema nicht identisch sind, und dass bei der nächsten Migration falscher Code Gerüstbau ist.</span><span class="sxs-lookup"><span data-stu-id="1a80a-267">This causes Code First to incorrectly detect that the current model and database schema don’t match and to scaffold incorrect code in the next migration.</span></span> <span data-ttu-id="1a80a-268">Diese Situation kann umgangen werden, indem eine leere Migration mit dem richtigen Modell erzeugt oder die Metadaten in der letzten Migration aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="1a80a-268">This situation can be overcome by generating a blank migration with the correct model, or updating the metadata in the latest migration.</span></span>
